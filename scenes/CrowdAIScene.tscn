[gd_scene load_steps=23 format=3 uid="uid://cw0bk0h1o70ne"]

[ext_resource type="PackedScene" uid="uid://bbquwaao37aja" path="res://assets/prefabs/characters/actor_ped.tscn" id="2_1nv3g"]
[ext_resource type="Script" uid="uid://bysxpb73lr46b" path="res://addons/FlowAI/scripts/core/FlowAIController.gd" id="2_cv82n"]
[ext_resource type="Texture2D" uid="uid://w45xs277sodg" path="res://assets/textures/grass/aerial_grass_rock_diff_1k.jpg" id="3_t6m7v"]
[ext_resource type="PackedScene" uid="uid://j5nwodo50yh3" path="res://assets/prefabs/characters/actor_player.tscn" id="4_cv82n"]
[ext_resource type="Texture2D" uid="uid://btuu6n8sqevkg" path="res://assets/textures/grass/aerial_grass_rock_nor_gl_1k.jpg" id="4_exg0k"]
[ext_resource type="Script" uid="uid://mk0cs7tsd178" path="res://scripts/core/systems/PedSpawner/PedSpawnerController.gd" id="5_8egd3"]
[ext_resource type="Texture2D" uid="uid://djp16kbej8g3y" path="res://assets/textures/grass/aerial_grass_rock_rough_1k.jpg" id="5_ivgad"]
[ext_resource type="PackedScene" uid="uid://t1k3huao4kgs" path="res://assets/prefabs/environments/road_pack/road_1x_straight.tscn" id="6_alfe8"]
[ext_resource type="PackedScene" uid="uid://c8ss606rlj773" path="res://assets/prefabs/environments/park_bench/so_park_bench.tscn" id="6_ivgad"]
[ext_resource type="PackedScene" uid="uid://c8jl2vxh0ppio" path="res://assets/prefabs/environments/road_pack/road_l_intersection.tscn" id="7_1dh4r"]
[ext_resource type="Texture2D" uid="uid://4pxnh1mqg4f6" path="res://assets/textures/hdri/qwantani_noon_puresky_2k.exr" id="7_72xuw"]
[ext_resource type="Script" uid="uid://csbl3jypfxtwg" path="res://addons/FlowAI/scripts/runtime/FlowAIAreaNode.gd" id="9_51afu"]
[ext_resource type="Script" uid="uid://i1dbg8h2x6sq" path="res://addons/FlowAI/scripts/runtime/FlowAIPathNode.gd" id="10_k6nio"]
[ext_resource type="Script" uid="uid://bchdkode3ag7t" path="res://scripts/core/nodes/FreeLookCamera.gd" id="11_exg0k"]
[ext_resource type="PackedScene" uid="uid://bxwxflsejagit" path="res://assets/prefabs/UI/crowd_ai_interface.tscn" id="13_exg0k"]

[sub_resource type="NavigationMesh" id="NavigationMesh_cv82n"]
vertices = PackedVector3Array(-6.619171, 0.496, -59.21277, -5.619171, 0.496, -59.46277, -5.619171, 0.496, -80.71277, -43.86917, 0.496, -80.71277, -43.86917, 0.496, -57.96277, -6.619171, 0.496, -57.71277, -4.619171, 0.496, -59.21277, -4.619171, 0.496, -57.46277, 4.130829, 0.496, -57.46277, 4.130829, 0.496, -59.21277, 5.130829, 0.496, -59.46277, 5.130829, 0.496, -80.71277, 6.130829, 0.496, -59.21277, 43.88083, 0.496, -57.96277, 43.88083, 0.496, -80.71277, 6.130829, 0.496, -57.71277, -43.86917, 0.496, -56.71277, -6.619171, 0.496, -56.96277, 6.130829, 0.496, -56.96277, 43.88083, 0.496, -56.71277, -5.619171, 0.496, -55.21277, -5.619171, 0.496, -48.46277, -4.619171, 0.496, -48.21277, 4.130829, 0.496, -48.21277, 5.130829, 0.496, -48.46277, 5.130829, 0.496, -55.21277, 4.130829, 0.496, -55.46277, -4.619171, 0.496, -55.46277, -4.619171, 0.496, -46.21277, 4.130829, 0.496, -46.21277, -6.619171, 0.496, -48.21277, -6.619171, 0.496, -55.46277, -43.86917, 0.496, -46.96277, -6.619171, 0.496, -46.71277, 6.130829, 0.496, -48.21277, 43.88083, 0.496, -46.96277, 6.130829, 0.496, -55.46277, 6.130829, 0.496, -46.71277, -43.86917, 0.496, -45.71277, -6.619171, 0.496, -45.96277, 6.130829, 0.496, -45.96277, 43.88083, 0.496, -45.71277, -4.619171, 0.496, -28.212769, -4.619171, 0.496, -26.462769, 4.130829, 0.496, -26.462769, 4.130829, 0.496, -28.212769, -5.619171, 0.496, -44.21277, -5.619171, 0.496, -28.462769, 5.130829, 0.496, -28.462769, 5.130829, 0.496, -44.21277, -4.619171, 0.496, -44.46277, 4.130829, 0.496, -44.46277, -6.619171, 0.496, -28.212769, -6.619171, 0.496, -44.46277, -43.86917, 0.496, -26.962769, -6.619171, 0.496, -26.712769, 6.130829, 0.496, -28.212769, 43.88083, 0.496, -26.962769, 6.130829, 0.496, -44.46277, 6.130829, 0.496, -26.712769, -43.86917, 0.496, -25.712769, -6.619171, 0.496, -25.962769, 6.130829, 0.496, -25.962769, 43.88083, 0.496, -25.712769, -5.619171, 0.496, -24.212769, -5.619171, 0.496, -18.462769, -4.619171, 0.496, -18.212769, 4.130829, 0.496, -18.212769, 5.130829, 0.496, -18.462769, 5.130829, 0.496, -24.212769, 4.130829, 0.496, -24.462769, -4.619171, 0.496, -24.462769, -4.619171, 0.496, -16.212769, 4.130829, 0.496, -16.212769, -6.619171, 0.496, -18.212769, -6.619171, 0.496, -24.462769, -43.86917, 0.496, -16.962769, -6.619171, 0.496, -16.712769, 6.130829, 0.496, -18.212769, 43.88083, 0.496, -16.962769, 6.130829, 0.496, -24.462769, 6.130829, 0.496, -16.712769, -43.86917, 0.496, -15.712769, -6.619171, 0.496, -15.962769, 6.130829, 0.496, -15.962769, 43.88083, 0.496, -15.712769, 4.130829, 0.496, -14.462769, -4.619171, 0.496, -14.462769, 5.130829, 0.496, -14.212769, -5.619171, 0.496, -14.212769, -5.619171, 0.496, 7.0372314, 5.130829, 0.496, 7.0372314, -6.619171, 0.496, -14.462769, -43.86917, 0.496, 7.0372314, 6.130829, 0.496, -14.462769, 43.88083, 0.496, 7.0372314)
polygons = [PackedInt32Array(1, 0, 2), PackedInt32Array(2, 0, 3), PackedInt32Array(3, 0, 4), PackedInt32Array(0, 5, 4), PackedInt32Array(9, 8, 6), PackedInt32Array(6, 8, 7), PackedInt32Array(6, 1, 9), PackedInt32Array(9, 1, 10), PackedInt32Array(10, 1, 2), PackedInt32Array(10, 2, 11), PackedInt32Array(10, 11, 12), PackedInt32Array(12, 11, 14), PackedInt32Array(12, 14, 13), PackedInt32Array(13, 15, 12), PackedInt32Array(17, 16, 5), PackedInt32Array(5, 16, 4), PackedInt32Array(15, 13, 18), PackedInt32Array(18, 13, 19), PackedInt32Array(22, 21, 20), PackedInt32Array(25, 24, 23), PackedInt32Array(20, 27, 22), PackedInt32Array(22, 27, 26), PackedInt32Array(22, 26, 25), PackedInt32Array(22, 25, 23), PackedInt32Array(27, 7, 26), PackedInt32Array(26, 7, 8), PackedInt32Array(23, 29, 22), PackedInt32Array(22, 29, 28), PackedInt32Array(21, 30, 20), PackedInt32Array(20, 30, 31), PackedInt32Array(31, 30, 32), PackedInt32Array(31, 32, 16), PackedInt32Array(16, 17, 31), PackedInt32Array(30, 33, 32), PackedInt32Array(25, 36, 24), PackedInt32Array(24, 36, 34), PackedInt32Array(34, 36, 19), PackedInt32Array(34, 19, 35), PackedInt32Array(36, 18, 19), PackedInt32Array(35, 37, 34), PackedInt32Array(39, 38, 33), PackedInt32Array(33, 38, 32), PackedInt32Array(37, 35, 40), PackedInt32Array(40, 35, 41), PackedInt32Array(45, 44, 42), PackedInt32Array(42, 44, 43), PackedInt32Array(50, 49, 46), PackedInt32Array(46, 49, 48), PackedInt32Array(46, 48, 45), PackedInt32Array(46, 45, 47), PackedInt32Array(50, 28, 51), PackedInt32Array(51, 28, 29), PackedInt32Array(50, 51, 49), PackedInt32Array(45, 42, 47), PackedInt32Array(47, 52, 46), PackedInt32Array(46, 52, 53), PackedInt32Array(53, 52, 54), PackedInt32Array(53, 54, 38), PackedInt32Array(38, 39, 53), PackedInt32Array(52, 55, 54), PackedInt32Array(49, 58, 48), PackedInt32Array(48, 58, 56), PackedInt32Array(56, 58, 41), PackedInt32Array(56, 41, 57), PackedInt32Array(58, 40, 41), PackedInt32Array(57, 59, 56), PackedInt32Array(61, 60, 55), PackedInt32Array(55, 60, 54), PackedInt32Array(59, 57, 62), PackedInt32Array(62, 57, 63), PackedInt32Array(66, 65, 64), PackedInt32Array(69, 68, 67), PackedInt32Array(64, 71, 66), PackedInt32Array(66, 71, 70), PackedInt32Array(66, 70, 69), PackedInt32Array(66, 69, 67), PackedInt32Array(71, 43, 70), PackedInt32Array(70, 43, 44), PackedInt32Array(67, 73, 66), PackedInt32Array(66, 73, 72), PackedInt32Array(65, 74, 64), PackedInt32Array(64, 74, 75), PackedInt32Array(75, 74, 76), PackedInt32Array(75, 76, 60), PackedInt32Array(60, 61, 75), PackedInt32Array(74, 77, 76), PackedInt32Array(69, 80, 68), PackedInt32Array(68, 80, 78), PackedInt32Array(78, 80, 63), PackedInt32Array(78, 63, 79), PackedInt32Array(80, 62, 63), PackedInt32Array(79, 81, 78), PackedInt32Array(83, 82, 77), PackedInt32Array(77, 82, 76), PackedInt32Array(81, 79, 84), PackedInt32Array(84, 79, 85), PackedInt32Array(87, 72, 86), PackedInt32Array(86, 72, 73), PackedInt32Array(86, 88, 87), PackedInt32Array(87, 88, 89), PackedInt32Array(89, 88, 91), PackedInt32Array(89, 91, 90), PackedInt32Array(89, 90, 92), PackedInt32Array(92, 90, 93), PackedInt32Array(92, 93, 82), PackedInt32Array(82, 83, 92), PackedInt32Array(88, 94, 91), PackedInt32Array(91, 94, 95), PackedInt32Array(95, 94, 85), PackedInt32Array(94, 84, 85)]

[sub_resource type="PlaneMesh" id="PlaneMesh_51afu"]
size = Vector2(60, 60)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_k6nio"]
albedo_texture = ExtResource("3_t6m7v")
roughness_texture = ExtResource("5_ivgad")
normal_enabled = true
normal_texture = ExtResource("4_exg0k")
uv1_scale = Vector3(0.085, 0.085, 0.085)
uv1_offset = Vector3(-0.135, 0, 0)
uv1_triplanar = true
uv1_triplanar_sharpness = 51.9841
uv1_world_triplanar = true

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_1yy8o"]
data = PackedVector3Array(30, 0, 30, -30, 0, 30, 30, 0, -30, -30, 0, 30, -30, 0, -30, 30, 0, -30)

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_8egd3"]
panorama = ExtResource("7_72xuw")

[sub_resource type="Sky" id="Sky_alfe8"]
sky_material = SubResource("PanoramaSkyMaterial_8egd3")

[sub_resource type="Environment" id="Environment_1dh4r"]
background_mode = 2
sky = SubResource("Sky_alfe8")

[node name="CrowdAIScene" type="Node3D"]

[node name="FlowAIController" type="Node" parent="." node_paths=PackedStringArray("all_areas", "all_pathnodes")]
process_priority = 1
process_physics_priority = 1
process_thread_group = 1
process_thread_group_order = 0
process_thread_messages = 0
script = ExtResource("2_cv82n")
is_debug_mode = true
DataPath = "res://data/CrowdAIScenePathnodesData.json"
all_areas = [NodePath("area_1")]
all_pathnodes = [NodePath("area_1/pathnode_1"), NodePath("area_1/pathnode_2"), NodePath("area_1/pathnode_3"), NodePath("area_1/pathnode_4"), NodePath("area_1/pathnode_5"), NodePath("area_1/pathnode_6"), NodePath("area_1/pathnode_7"), NodePath("area_1/pathnode_8"), NodePath("area_1/pathnode_9")]
metadata/_custom_type_script = "uid://bysxpb73lr46b"

[node name="area_1" type="Node3D" parent="FlowAIController" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -35)
script = ExtResource("9_51afu")
flowAI_controller = NodePath("..")

[node name="pathnode_1" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 30.18274, 0, 0)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_2" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 30.18274, 0, -32)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_3" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.18273926, 0, -32)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_4" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -30.120937, 0, -32)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_5" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -30.120937, 0, -1)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_6" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -30.120937, 0, 28.374788)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_7" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.12093735, 0, 28.374788)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_8" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 30.035301, 0, 28.374788)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="pathnode_9" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.18273926, 0, 0)
script = ExtResource("10_k6nio")
flowAI_controller = NodePath("../..")

[node name="map" type="Node" parent="."]

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="map"]
navigation_mesh = SubResource("NavigationMesh_cv82n")

[node name="road_pack" type="Node" parent="map/NavigationRegion3D"]

[node name="Road_1X_Straight" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("6_alfe8")]
transform = Transform3D(0.004, 0, 0, 0, 0.004, 0, 0, 0, 0.004, 0, -0.004, 0)

[node name="Road_1X_Straight2" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("6_alfe8")]
transform = Transform3D(-1.74846e-10, 0, 0.004, 0, 0.004, 0, -0.004, 0, -1.74846e-10, 36.835, -0.004, -36.825)

[node name="Road_1X_Straight3" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("6_alfe8")]
transform = Transform3D(-0.004, 0, -3.49691e-10, 0, 0.004, 0, 3.49691e-10, 0, -0.004, 0.02, -0.004, -73.615)

[node name="Road_L_Intersection" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("7_1dh4r")]
transform = Transform3D(-1.74846e-10, 0, 0.004, 0, 0.004, 0, -0.004, 0, -1.74846e-10, 36.838, 0.049, 0)

[node name="Road_L_Intersection2" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("7_1dh4r")]
transform = Transform3D(-0.004, 0, -3.49691e-10, 0, 0.004, 0, 3.49691e-10, 0, -0.004, 36.838, 0.037, -73.619)

[node name="Road_1X_Straight4" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("6_alfe8")]
transform = Transform3D(-1.74846e-10, 0, -0.004, 0, 0.004, 0, 0.004, 0, -1.74846e-10, -36.786, -0.004, -36.8046)

[node name="Road_L_Intersection3" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("7_1dh4r")]
transform = Transform3D(-1.74846e-10, 0, -0.004, 0, 0.004, 0, 0.004, 0, -1.74846e-10, -36.786, 0.049, -73.6296)

[node name="Road_L_Intersection4" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("7_1dh4r")]
transform = Transform3D(0.004, 0, 0, 0, 0.004, 0, 0, 0, 0.004, -36.786, 0.049, -0.0102234)

[node name="park_bench" type="Node" parent="map/NavigationRegion3D"]

[node name="so_park_bench" parent="map/NavigationRegion3D/park_bench" instance=ExtResource("6_ivgad")]
transform = Transform3D(1.6, 0, 0, 0, 1.6, 0, 0, 0, 1.6, -7, 0, -9.7394085)

[node name="so_park_bench2" parent="map/NavigationRegion3D/park_bench" instance=ExtResource("6_ivgad")]
transform = Transform3D(1.6, 0, 0, 0, 1.6, 0, 0, 0, 1.6, 6, 0, -9.7394085)

[node name="MeshInstance3D" type="MeshInstance3D" parent="map/NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0760803, -36.7016)
mesh = SubResource("PlaneMesh_51afu")
skeleton = NodePath("../..")
surface_material_override/0 = SubResource("StandardMaterial3D_k6nio")

[node name="StaticBody3D" type="StaticBody3D" parent="map/NavigationRegion3D/MeshInstance3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="map/NavigationRegion3D/MeshInstance3D/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_1yy8o")

[node name="PedSpawnerController" type="Node" parent="map" node_paths=PackedStringArray("SpawnerSlotsPath", "SpawnerNpcPath", "FlowAIControllerNode", "PlayerRef")]
process_priority = 1
script = ExtResource("5_8egd3")
SpawnerSlotsPath = NodePath("Spawners")
SpawnerNpcPath = NodePath("../../actor")
FlowAIControllerNode = NodePath("../../FlowAIController")
PlayerRef = NodePath("../../actor/actor_player")
NpcScene = ExtResource("2_1nv3g")
peds_pool_size = 50
despawn_radius = 105.0
metadata/_custom_type_script = "uid://mk0cs7tsd178"

[node name="Spawners" type="Node" parent="map/PedSpawnerController"]

[node name="actor" type="Node" parent="."]

[node name="actor_player" parent="actor" instance=ExtResource("4_cv82n")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -3)

[node name="FreeLookCamera" type="Camera3D" parent="actor"]
process_mode = 4
script = ExtResource("11_exg0k")
metadata/_custom_type_script = "uid://bchdkode3ag7t"

[node name="RuntimeCreatedBodies" type="Node" parent="."]

[node name="CrowdAIInterface" parent="." node_paths=PackedStringArray("ped_spawner_controller") instance=ExtResource("13_exg0k")]
ped_spawner_controller = NodePath("../map/PedSpawnerController")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_1dh4r")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true
