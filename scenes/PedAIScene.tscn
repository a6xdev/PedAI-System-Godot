[gd_scene load_steps=22 format=3 uid="uid://cw0bk0h1o70ne"]

[ext_resource type="Script" uid="uid://bysxpb73lr46b" path="res://addons/FlowAI/scripts/core/FlowAIController.gd" id="1_mtgui"]
[ext_resource type="Script" uid="uid://csbl3jypfxtwg" path="res://addons/FlowAI/scripts/runtime/FlowAIAreaNode.gd" id="2_pm0x4"]
[ext_resource type="Script" uid="uid://i1dbg8h2x6sq" path="res://addons/FlowAI/scripts/runtime/FlowAIPathNode.gd" id="3_fgoei"]
[ext_resource type="PackedScene" uid="uid://t1k3huao4kgs" path="res://assets/prefabs/environments/road_pack/road_1x_straight.tscn" id="4_lga2r"]
[ext_resource type="PackedScene" uid="uid://c8jl2vxh0ppio" path="res://assets/prefabs/environments/road_pack/road_l_intersection.tscn" id="5_3ju2v"]
[ext_resource type="PackedScene" uid="uid://c8ss606rlj773" path="res://assets/prefabs/environments/park_bench/so_park_bench.tscn" id="6_ry8yx"]
[ext_resource type="Texture2D" uid="uid://w45xs277sodg" path="res://assets/textures/grass/aerial_grass_rock_diff_1k.jpg" id="7_wiv7x"]
[ext_resource type="Texture2D" uid="uid://btuu6n8sqevkg" path="res://assets/textures/grass/aerial_grass_rock_nor_gl_1k.jpg" id="8_k3on3"]
[ext_resource type="Texture2D" uid="uid://djp16kbej8g3y" path="res://assets/textures/grass/aerial_grass_rock_rough_1k.jpg" id="9_ny0f5"]
[ext_resource type="Script" uid="uid://mk0cs7tsd178" path="res://scripts/core/systems/PedSpawner/PedSpawnerController.gd" id="10_mlmhb"]
[ext_resource type="PackedScene" uid="uid://bbquwaao37aja" path="res://assets/prefabs/characters/actor_ped.tscn" id="11_bma6s"]
[ext_resource type="PackedScene" uid="uid://j5nwodo50yh3" path="res://assets/prefabs/characters/actor_player.tscn" id="12_dhite"]
[ext_resource type="PackedScene" uid="uid://bxwxflsejagit" path="res://assets/prefabs/UI/crowd_ai_interface.tscn" id="14_dex2l"]
[ext_resource type="Texture2D" uid="uid://4pxnh1mqg4f6" path="res://assets/textures/hdri/qwantani_noon_puresky_2k.exr" id="15_ggsc2"]

[sub_resource type="NavigationMesh" id="NavigationMesh_cv82n"]
vertices = PackedVector3Array(-4.869171, 0.476722, -10.712769, 1.6308289, 0.476722, -19.962769, 1.8808289, 0.476722, -21.462769, -9.369171, 0.476722, -10.712769, -43.86917, 0.476722, 7.0372314, 3.1308289, 0.476722, -80.71277, -43.86917, 0.476722, -80.71277, -9.119171, 0.476722, 7.0372314, -9.119171, 0.476722, -8.462769, -9.619171, 0.476722, -8.712769, 3.3808289, 0.476722, -21.462769, 4.380829, 0.476722, -21.462769, 4.630829, 0.476722, -80.71277, 5.880829, 0.476722, -21.462769, 6.130829, 0.476722, -19.962769, 7.380829, 0.476722, -18.712769, 8.880829, 0.476722, -18.462769, 43.88083, 0.476722, -16.462769, 43.88083, 0.476722, -80.71277, 8.880829, 0.476722, -16.462769, 6.880829, 0.476722, -18.462769, 5.880829, 0.476722, -19.462769, -4.369171, 0.476722, -10.462769, 3.6308289, 0.476722, -9.712769, 3.8808289, 0.476722, -10.712769, 1.8808289, 0.476722, -19.462769, 7.630829, 0.476722, -10.712769, 7.630829, 0.476722, -14.212769, 6.880829, 0.476722, -14.462769, -4.369171, 0.476722, -9.712769, 8.880829, 0.476722, -14.462769, 8.380829, 0.476722, -10.212769, 8.380829, 0.476722, -9.212769, 7.880829, 0.476722, -8.712769, 6.380829, 0.476722, -8.712769, 6.630829, 0.476722, 7.0372314, 43.88083, 0.476722, 7.0372314, -4.369171, 0.476722, -8.712769, 3.8808289, 0.476722, -8.712769, -4.869171, 0.476722, -8.462769, -4.869171, 0.476722, 7.0372314)
polygons = [PackedInt32Array(1, 0, 2), PackedInt32Array(2, 0, 3), PackedInt32Array(3, 4, 2), PackedInt32Array(2, 4, 5), PackedInt32Array(5, 4, 6), PackedInt32Array(8, 7, 9), PackedInt32Array(9, 7, 4), PackedInt32Array(5, 10, 2), PackedInt32Array(3, 9, 4), PackedInt32Array(10, 5, 11), PackedInt32Array(11, 5, 12), PackedInt32Array(15, 14, 13), PackedInt32Array(15, 13, 16), PackedInt32Array(16, 13, 17), PackedInt32Array(17, 13, 12), PackedInt32Array(17, 12, 18), PackedInt32Array(17, 19, 16), PackedInt32Array(13, 11, 12), PackedInt32Array(21, 14, 20), PackedInt32Array(20, 14, 15), PackedInt32Array(22, 0, 23), PackedInt32Array(23, 0, 24), PackedInt32Array(24, 0, 25), PackedInt32Array(25, 0, 1), PackedInt32Array(27, 26, 28), PackedInt32Array(28, 26, 24), PackedInt32Array(23, 29, 22), PackedInt32Array(20, 28, 21), PackedInt32Array(21, 28, 25), PackedInt32Array(25, 28, 24), PackedInt32Array(26, 27, 31), PackedInt32Array(31, 27, 30), PackedInt32Array(30, 19, 17), PackedInt32Array(31, 30, 32), PackedInt32Array(32, 30, 17), PackedInt32Array(35, 34, 33), PackedInt32Array(33, 32, 35), PackedInt32Array(35, 32, 36), PackedInt32Array(36, 32, 17), PackedInt32Array(37, 29, 23), PackedInt32Array(37, 23, 39), PackedInt32Array(39, 23, 38), PackedInt32Array(38, 34, 39), PackedInt32Array(39, 34, 40), PackedInt32Array(40, 34, 35), PackedInt32Array(39, 40, 8), PackedInt32Array(8, 40, 7)]

[sub_resource type="PlaneMesh" id="PlaneMesh_51afu"]
size = Vector2(60, 60)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_k6nio"]
albedo_texture = ExtResource("7_wiv7x")
roughness_texture = ExtResource("9_ny0f5")
normal_enabled = true
normal_texture = ExtResource("8_k3on3")
uv1_scale = Vector3(0.085, 0.085, 0.085)
uv1_offset = Vector3(-0.135, 0, 0)
uv1_triplanar = true
uv1_triplanar_sharpness = 51.9841
uv1_world_triplanar = true

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_1yy8o"]
data = PackedVector3Array(30, 0, 30, -30, 0, 30, 30, 0, -30, -30, 0, 30, -30, 0, -30, 30, 0, -30)

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_8egd3"]
panorama = ExtResource("15_ggsc2")

[sub_resource type="Sky" id="Sky_alfe8"]
sky_material = SubResource("PanoramaSkyMaterial_8egd3")

[sub_resource type="Environment" id="Environment_1dh4r"]
background_mode = 2
sky = SubResource("Sky_alfe8")

[node name="PedAIScene" type="Node3D"]

[node name="FlowAIController" type="Node" parent="." node_paths=PackedStringArray("all_areas", "all_pathnodes")]
script = ExtResource("1_mtgui")
DataPath = "res://data/PedAIScene_FlowAIData.json"
all_areas = [NodePath("area_1")]
all_pathnodes = [NodePath("area_1/pathnode_1"), NodePath("area_1/pathnode_2"), NodePath("area_1/pathnode_3"), NodePath("area_1/pathnode_4"), NodePath("area_1/pathnode_5"), NodePath("area_1/pathnode_6"), NodePath("area_1/pathnode_7"), NodePath("area_1/pathnode_8"), NodePath("area_1/pathnode_9"), NodePath("area_1/pathnode_10")]
show_pathnode_shape = true
show_pathnode_label = true
metadata/_custom_type_script = "uid://bysxpb73lr46b"

[node name="area_1" type="Node3D" parent="FlowAIController" node_paths=PackedStringArray("flow_controller")]
script = ExtResource("2_pm0x4")
flow_controller = NodePath("..")
area_pathnodes = Array[int]([1, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10])

[node name="pathnode_1" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_2" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.07778859, -6.8038177)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_3" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -7, 0.07778859, -6.8038177)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_4" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6, 0.07778859, -6.8038177)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_5" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.07778859, -14.803818)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_6" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.07778859, -22.803818)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_7" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0.07778859, -22.803818)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_8" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 0.07778859, -22.803818)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_9" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 0.07778859, -15.803818)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="pathnode_10" type="Marker3D" parent="FlowAIController/area_1" node_paths=PackedStringArray("flow_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 0.07778859, -7.8038177)
script = ExtResource("3_fgoei")
flow_controller = NodePath("../..")

[node name="map" type="Node" parent="."]

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="map"]
navigation_mesh = SubResource("NavigationMesh_cv82n")

[node name="road_pack" type="Node" parent="map/NavigationRegion3D"]

[node name="Road_1X_Straight" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("4_lga2r")]
transform = Transform3D(0.004, 0, 0, 0, 0.004, 0, 0, 0, 0.004, 0, -0.004, 0)

[node name="Road_1X_Straight2" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("4_lga2r")]
transform = Transform3D(-1.74846e-10, 0, 0.004, 0, 0.004, 0, -0.004, 0, -1.74846e-10, 36.835, -0.004, -36.825)

[node name="Road_1X_Straight3" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("4_lga2r")]
transform = Transform3D(-0.004, 0, -3.49691e-10, 0, 0.004, 0, 3.49691e-10, 0, -0.004, 0.02, -0.004, -73.615)

[node name="Road_L_Intersection" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("5_3ju2v")]
transform = Transform3D(-1.74846e-10, 0, 0.004, 0, 0.004, 0, -0.004, 0, -1.74846e-10, 36.838, 0.049, 0)

[node name="Road_L_Intersection2" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("5_3ju2v")]
transform = Transform3D(-0.004, 0, -3.49691e-10, 0, 0.004, 0, 3.49691e-10, 0, -0.004, 36.838, 0.037, -73.619)

[node name="Road_1X_Straight4" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("4_lga2r")]
transform = Transform3D(-1.74846e-10, 0, -0.004, 0, 0.004, 0, 0.004, 0, -1.74846e-10, -36.786, -0.004, -36.8046)

[node name="Road_L_Intersection3" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("5_3ju2v")]
transform = Transform3D(-1.74846e-10, 0, -0.004, 0, 0.004, 0, 0.004, 0, -1.74846e-10, -36.786, 0.049, -73.6296)

[node name="Road_L_Intersection4" parent="map/NavigationRegion3D/road_pack" instance=ExtResource("5_3ju2v")]
transform = Transform3D(0.004, 0, 0, 0, 0.004, 0, 0, 0, 0.004, -36.786, 0.049, -0.0102234)

[node name="park_bench" type="Node" parent="map/NavigationRegion3D"]

[node name="so_park_bench" parent="map/NavigationRegion3D/park_bench" instance=ExtResource("6_ry8yx")]
transform = Transform3D(1.6, 0, 0, 0, 1.6, 0, 0, 0, 1.6, -7, 0.072, -9.7394085)

[node name="so_park_bench2" parent="map/NavigationRegion3D/park_bench" instance=ExtResource("6_ry8yx")]
transform = Transform3D(1.325, 0, 0, 0, 1.325, 0, 0, 0, 1.325, 6, 0.072, -9.7394085)

[node name="so_park_bench3" parent="map/NavigationRegion3D/park_bench" instance=ExtResource("6_ry8yx")]
transform = Transform3D(-5.7917592e-08, 0, 1.325, 0, 1.325, 0, -1.325, 0, -5.7917592e-08, 7.8664303, 0.072, -16.34635)
sit_rotation_y = 90.0

[node name="so_park_bench4" parent="map/NavigationRegion3D/park_bench" instance=ExtResource("6_ry8yx")]
transform = Transform3D(-1.325, 0, -1.15835185e-07, 0, 1.325, 0, 1.15835185e-07, 0, -1.325, 3.8664303, 0.072, -20.34635)
sit_rotation_y = 180.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="map/NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0760803, -36.7016)
mesh = SubResource("PlaneMesh_51afu")
skeleton = NodePath("../..")
surface_material_override/0 = SubResource("StandardMaterial3D_k6nio")

[node name="StaticBody3D" type="StaticBody3D" parent="map/NavigationRegion3D/MeshInstance3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="map/NavigationRegion3D/MeshInstance3D/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_1yy8o")

[node name="PedSpawnerController" type="Node" parent="map" node_paths=PackedStringArray("SpawnerSlotsPath", "SpawnerNpcPath", "FlowAIControllerNode", "PlayerRef")]
process_priority = 1
script = ExtResource("10_mlmhb")
SpawnerSlotsPath = NodePath("Spawners")
SpawnerNpcPath = NodePath("../../actor")
FlowAIControllerNode = NodePath("../../FlowAIController")
PlayerRef = NodePath("../../actor/actor_player")
NpcScene = ExtResource("11_bma6s")
peds_pool_size = 1
spawn_radius = 15.0
despawn_radius = 20.0
metadata/_custom_type_script = "uid://mk0cs7tsd178"

[node name="Spawners" type="Node" parent="map/PedSpawnerController"]

[node name="actor" type="Node" parent="."]

[node name="actor_player" parent="actor" instance=ExtResource("12_dhite")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -3)

[node name="RuntimeCreatedBodies" type="Node" parent="."]

[node name="CrowdAIInterface" parent="." node_paths=PackedStringArray("ped_spawner_controller") instance=ExtResource("14_dex2l")]
ped_spawner_controller = NodePath("../map/PedSpawnerController")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_1dh4r")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true
